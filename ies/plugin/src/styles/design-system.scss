/**
 * IES Explorer Design System
 * Aesthetic: "Hybrid Contemplative"
 *
 * A refined, scholarly environment for deep thought.
 * Combines Scholar's Library warmth, Cupertino refinement,
 * Neurogarden ADHD-friendly patterns, and Asri modern geometry.
 *
 * This file imports the unified design system tokens and extends
 * them with SCSS-specific features for the SiYuan plugin.
 */

// ============================================
// UNIFIED DESIGN SYSTEM TOKENS
// ============================================

// Design system tokens imported from index.scss
// (CSS imports have path resolution issues when nested in SCSS)

// ============================================
// SCSS EXTENSIONS
// ============================================
// These classes use SCSS features like @extend and @for loops
// that cannot be expressed in pure CSS

.ies-root {
  font-family: var(--ies-font-body);
  font-size: var(--ies-text-base);
  line-height: var(--ies-leading-body);
  color: var(--ies-text-primary);
  background: var(--ies-bg-deep);

  // Smooth font rendering
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  // Selection color
  ::selection {
    background: var(--ies-accent-muted);
    color: var(--ies-text-primary);
  }
}

// ============================================
// TYPOGRAPHY CLASSES (SCSS Extensions)
// ============================================

.ies-heading {
  font-family: var(--ies-font-display);
  font-weight: var(--ies-font-semibold);
  letter-spacing: var(--ies-tracking-tight);
  line-height: var(--ies-leading-tight);
}

.ies-heading-xl {
  @extend .ies-heading;
  font-size: var(--ies-text-4xl);
}

.ies-heading-lg {
  @extend .ies-heading;
  font-size: var(--ies-text-3xl);
}

.ies-heading-md {
  @extend .ies-heading;
  font-size: var(--ies-text-2xl);
}

.ies-heading-sm {
  @extend .ies-heading;
  font-size: var(--ies-text-xl);
}

.ies-label {
  font-size: var(--ies-text-xs);
  font-weight: var(--ies-font-bold);
  letter-spacing: var(--ies-tracking-widest);
  text-transform: uppercase;
  color: var(--ies-text-muted);
}

.ies-mono {
  font-family: var(--ies-font-mono);
  font-size: 0.9em;
}

// ============================================
// COMPONENT EXTENSIONS (SCSS Features)
// ============================================

.ies-card--interactive {
  cursor: pointer;

  &:hover {
    transform: translateY(-2px);
  }

  &:active {
    transform: translateY(0);
    box-shadow: var(--ies-shadow-card);
  }
}

.ies-card--accent {
  border-left: 3px solid var(--ies-accent);
}

.ies-card--secondary {
  border-left: 3px solid var(--ies-secondary);
}

.ies-chip--accent {
  background: var(--ies-accent-muted);
  border-color: var(--ies-accent);
  color: var(--ies-accent);
}

.ies-chip--secondary {
  background: var(--ies-secondary-muted);
  border-color: var(--ies-secondary);
  color: var(--ies-secondary);
}

.ies-btn--ghost {
  background: transparent;
  border-color: transparent;
  box-shadow: none;

  &:hover:not(:disabled) {
    background: var(--ies-bg-deep);
    border-color: transparent;
  }
}

.ies-btn--icon {
  padding: var(--ies-space-2);
  border-radius: var(--ies-radius-button);
}

.ies-textarea {
  width: 100%;
  padding: var(--ies-input-padding-y) var(--ies-input-padding-x);
  font-family: var(--ies-font-body);
  font-size: var(--ies-text-base);
  color: var(--ies-text-primary);
  background: var(--ies-bg-base);
  border: 1px solid var(--ies-border-light);
  border-radius: var(--ies-radius-input);
  box-shadow: var(--ies-shadow-input);
  transition: var(--ies-transition-all);
  resize: none;
  line-height: 1.5;

  &::placeholder {
    color: var(--ies-text-subtle);
  }

  &:focus {
    outline: none;
    border-color: var(--ies-accent);
    box-shadow: var(--ies-shadow-input-focus);
  }
}

// ============================================
// ANIMATION UTILITIES (SCSS Features)
// ============================================

.ies-fade-in {
  animation: ies-fade-in var(--ies-duration-base) var(--ies-ease-cupertino);
}

.ies-slide-up {
  animation: ies-slide-up var(--ies-duration-slow) var(--ies-ease-cupertino);
}

.ies-stagger {
  animation: ies-slide-up var(--ies-duration-slow) var(--ies-ease-cupertino) backwards;

  @for $i from 1 through 10 {
    &:nth-child(#{$i}) {
      animation-delay: #{$i * 50}ms;
    }
  }
}

.ies-loading {
  animation: ies-pulse-soft 1.5s var(--ies-ease-in-out) infinite;
}

.ies-shimmer {
  background: linear-gradient(
    90deg,
    var(--ies-bg-base) 0%,
    var(--ies-bg-elevated) 50%,
    var(--ies-bg-base) 100%
  );
  background-size: 200% 100%;
  animation: ies-shimmer 1.5s ease-in-out infinite;
}

// Scrollbar styling
.ies-scrollable {
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--ies-border-medium) transparent;

  &::-webkit-scrollbar {
    width: 6px;
  }

  &::-webkit-scrollbar-track {
    background: transparent;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--ies-border-medium);
    border-radius: 3px;

    &:hover {
      background: var(--ies-text-subtle);
    }
  }
}

// ============================================
// ENTITY TYPE CHIPS (SCSS Extensions)
// ============================================

.ies-entity-chip {
  display: inline-flex;
  align-items: center;
  gap: var(--ies-space-1);
  padding: var(--ies-space-1) var(--ies-space-2);
  font-size: var(--ies-text-xs);
  font-weight: var(--ies-font-semibold);
  border-radius: var(--ies-radius-chip);
  transition: var(--ies-transition-fast);

  &--concept {
    color: var(--ies-entity-concept);
    background: var(--ies-entity-concept-bg);
  }

  &--person {
    color: var(--ies-entity-person);
    background: var(--ies-entity-person-bg);
  }

  &--theory {
    color: var(--ies-entity-theory);
    background: var(--ies-entity-theory-bg);
  }

  &--framework {
    color: var(--ies-entity-framework);
    background: var(--ies-entity-framework-bg);
  }

  &--assessment {
    color: var(--ies-entity-assessment);
    background: var(--ies-entity-assessment-bg);
  }
}

// ============================================
// QUESTION CLASS BADGES (SCSS Extensions)
// ============================================

.ies-qc-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--ies-space-1);
  padding: 2px var(--ies-space-2);
  font-size: var(--ies-text-xs);
  font-weight: var(--ies-font-medium);
  border-radius: var(--ies-radius-sm);
  background: var(--ies-bg-base);
  border: 1px solid currentColor;
  opacity: 0.9;

  &--schema-probe { color: var(--ies-q-schema); }
  &--boundary { color: var(--ies-q-boundary); }
  &--dimensional { color: var(--ies-q-dimensional); }
  &--causal { color: var(--ies-q-causal); }
  &--counterfactual { color: var(--ies-q-counterfactual); }
  &--anchor { color: var(--ies-q-anchor); }
  &--perspective-shift { color: var(--ies-q-perspective); }
  &--meta-cognitive { color: var(--ies-q-meta); }
  &--reflective-synthesis { color: var(--ies-q-synthesis); }
}

// ============================================
// ENERGY & RESONANCE INDICATORS (SCSS Extensions)
// ============================================

.ies-energy-indicator {
  display: inline-flex;
  align-items: center;
  gap: var(--ies-space-1);
  padding: var(--ies-space-1) var(--ies-space-2);
  font-size: var(--ies-text-xs);
  font-weight: var(--ies-font-semibold);
  border-radius: var(--ies-radius-chip);

  &--low {
    color: var(--ies-energy-low);
    background: var(--ies-energy-low-bg);
  }

  &--medium {
    color: var(--ies-energy-medium);
    background: var(--ies-energy-medium-bg);
  }

  &--high {
    color: var(--ies-energy-high);
    background: var(--ies-energy-high-bg);
  }
}

.ies-resonance-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;

  // Map resonance signals to question class colors for consistency
  &--curious { background: var(--ies-q-schema); }
  &--excited { background: var(--ies-q-causal); }
  &--surprised { background: var(--ies-q-counterfactual); }
  &--moved { background: var(--ies-q-perspective); }
  &--disturbed { background: var(--ies-energy-high); }
  &--unclear { background: var(--ies-q-meta); }
  &--connected { background: var(--ies-q-anchor); }
  &--validated { background: var(--ies-accent); }
}

// ============================================
// SIYUAN-SPECIFIC OVERRIDES
// ============================================

// Integrate with SiYuan's dark mode
[data-theme-mode="dark"] {
  .ies-root {
    background: var(--ies-bg-deep);
    color: var(--ies-text-primary);
  }
}
