/**
 * IES Design System v2 - SCSS Extensions
 * Aesthetic: "Modern Information Space"
 *
 * A sleek, modern interface inspired by Linear, Raycast, and Arc.
 * Dark mode first with entity colors as primary accents.
 *
 * This file provides SCSS-specific features (@extend, loops, nesting)
 * that extend the CSS custom properties defined in design-system/*.css
 */

// ============================================
// UNIFIED DESIGN SYSTEM TOKENS
// ============================================
// CSS tokens imported via index.css in the design-system folder
// This file extends those tokens with SCSS features

// ============================================
// ROOT ELEMENT STYLING
// ============================================

.ies-root {
  font-family: var(--font-sans);
  font-size: var(--text-base);
  line-height: var(--leading-body);
  color: var(--text-primary);
  background: var(--bg-primary);

  // Smooth font rendering
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  // Selection color (entity concept blue)
  ::selection {
    background: rgba(59, 130, 246, 0.3);
    color: var(--text-primary);
  }
}

// ============================================
// TYPOGRAPHY CLASSES (SCSS Extensions)
// ============================================

.ies-heading {
  font-family: var(--font-sans);
  font-weight: var(--font-semibold);
  letter-spacing: var(--tracking-tight);
  line-height: var(--leading-tight);
}

.ies-heading-xl {
  @extend .ies-heading;
  font-size: var(--text-3xl);
}

.ies-heading-lg {
  @extend .ies-heading;
  font-size: var(--text-2xl);
}

.ies-heading-md {
  @extend .ies-heading;
  font-size: var(--text-xl);
}

.ies-heading-sm {
  @extend .ies-heading;
  font-size: var(--text-lg);
}

.ies-label {
  font-size: var(--text-xs);
  font-weight: var(--font-bold);
  letter-spacing: var(--tracking-widest);
  text-transform: uppercase;
  color: var(--text-muted);
}

.ies-mono {
  font-family: var(--font-mono);
  font-size: 0.9em;
}

// ============================================
// COMPONENT EXTENSIONS (SCSS Features)
// ============================================

.ies-card--interactive {
  cursor: pointer;

  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-card-hover);
  }

  &:active {
    transform: translateY(0);
    box-shadow: var(--shadow-card);
  }
}

.ies-card--accent {
  border-left: 3px solid var(--entity-concept);
}

.ies-card--secondary {
  border-left: 3px solid var(--entity-theory);
}

.ies-chip--accent {
  background: var(--entity-concept-bg);
  border-color: var(--entity-concept);
  color: var(--entity-concept);
}

.ies-chip--secondary {
  background: var(--entity-theory-bg);
  border-color: var(--entity-theory);
  color: var(--entity-theory);
}

.ies-btn--ghost {
  background: transparent;
  border-color: transparent;
  box-shadow: none;

  &:hover:not(:disabled) {
    background: var(--bg-hover);
    border-color: transparent;
  }
}

.ies-btn--icon {
  padding: var(--space-2);
  border-radius: var(--radius-md);
}

.ies-textarea {
  width: 100%;
  padding: var(--input-padding-y) var(--input-padding-x);
  font-family: var(--font-sans);
  font-size: var(--text-base);
  color: var(--text-primary);
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-input);
  box-shadow: var(--shadow-input);
  transition: var(--transition-all);
  resize: none;
  line-height: 1.5;

  &::placeholder {
    color: var(--text-muted);
  }

  &:focus {
    outline: none;
    border-color: var(--entity-concept);
    box-shadow: var(--shadow-input-focus);
  }
}

// ============================================
// ANIMATION UTILITIES (SCSS Features)
// ============================================

.ies-fade-in {
  animation: fade-in var(--duration-base) var(--ease-out);
}

.ies-slide-up {
  animation: slide-up var(--duration-slow) var(--ease-out);
}

.ies-stagger {
  animation: slide-up var(--duration-slow) var(--ease-out) backwards;

  @for $i from 1 through 10 {
    &:nth-child(#{$i}) {
      animation-delay: #{$i * 40}ms;
    }
  }
}

.ies-loading {
  animation: pulse-soft 1.5s var(--ease-in-out) infinite;
}

.ies-shimmer {
  background: linear-gradient(
    90deg,
    var(--bg-secondary) 0%,
    var(--bg-tertiary) 50%,
    var(--bg-secondary) 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

// Scrollbar styling (modern minimal)
.ies-scrollable {
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--bg-hover) transparent;

  &::-webkit-scrollbar {
    width: 6px;
  }

  &::-webkit-scrollbar-track {
    background: transparent;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--bg-hover);
    border-radius: 3px;

    &:hover {
      background: var(--bg-active);
    }
  }
}

// ============================================
// ENTITY TYPE CHIPS (SCSS Extensions)
// ============================================

.ies-entity-chip {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  border-radius: var(--radius-chip);
  transition: var(--transition-fast);

  &--concept {
    color: var(--entity-concept);
    background: var(--entity-concept-bg);
  }

  &--person {
    color: var(--entity-person);
    background: var(--entity-person-bg);
  }

  &--theory {
    color: var(--entity-theory);
    background: var(--entity-theory-bg);
  }

  &--framework {
    color: var(--entity-framework);
    background: var(--entity-framework-bg);
  }

  &--assessment {
    color: var(--entity-assessment);
    background: var(--entity-assessment-bg);
  }
}

// ============================================
// QUESTION CLASS BADGES (SCSS Extensions)
// ============================================

.ies-qc-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: 2px var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  border-radius: var(--radius-sm);
  background: var(--bg-secondary);
  border: 1px solid currentColor;
  opacity: 0.9;

  &--schema-probe { color: var(--q-schema); }
  &--boundary { color: var(--q-boundary); }
  &--dimensional { color: var(--q-dimensional); }
  &--causal { color: var(--q-causal); }
  &--counterfactual { color: var(--q-counterfactual); }
  &--anchor { color: var(--q-anchor); }
  &--perspective-shift { color: var(--q-perspective); }
  &--meta-cognitive { color: var(--q-meta); }
  &--reflective-synthesis { color: var(--q-synthesis); }
}

// ============================================
// ENERGY & RESONANCE INDICATORS (SCSS Extensions)
// ============================================

.ies-energy-indicator {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  border-radius: var(--radius-chip);

  &--low {
    color: var(--energy-low);
    background: var(--energy-low-bg);
  }

  &--medium {
    color: var(--energy-medium);
    background: var(--energy-medium-bg);
  }

  &--high {
    color: var(--energy-high);
    background: var(--energy-high-bg);
  }
}

.ies-resonance-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;

  // Map resonance signals to question class colors for consistency
  &--curious { background: var(--q-schema); }
  &--excited { background: var(--q-causal); }
  &--surprised { background: var(--q-counterfactual); }
  &--moved { background: var(--q-perspective); }
  &--disturbed { background: var(--energy-high); }
  &--unclear { background: var(--q-meta); }
  &--connected { background: var(--q-anchor); }
  &--validated { background: var(--entity-concept); }
}

// ============================================
// SIYUAN-SPECIFIC OVERRIDES
// ============================================

// Integrate with SiYuan's dark mode
[data-theme-mode="dark"] {
  .ies-root {
    background: var(--bg-primary);
    color: var(--text-primary);
  }
}

// Integrate with SiYuan's light mode
[data-theme-mode="light"] {
  .ies-root {
    background: var(--bg-primary);
    color: var(--text-primary);
  }
}
